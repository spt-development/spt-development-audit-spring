language: java

jdk:
  - openjdk15

script:
  - mvn test -B
  - mvn org.pitest:pitest-maven:mutationCoverage

before_deploy:
  - POM_VERSION=$(mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec)

# Releases config copied from https://docs.travis-ci.com/user/deployment/releases/ and secure key generated by following
# https://stackoverflow.com/questions/25302518/travis-ci-setup-releases-with-github-token#answer-57032190
deploy:
  provider: releases
  api_key:
    secure: WLggAaxxIxiDMOE73wPTbK0QuLMW1kGfbR5PtTtK0zdvbJDu22kCH6M4oXH9oVaK6J1L1LpLBjzcKlYKwkJcFdhpfGCwXWS7oJl5tDklLEkQkL+2HkPlsrm4WX+q8OPPcxtHy2ZXhtGoXnwR1EjB+Ro+AvAVpqKUqtYHxScXmxXiJc7Uzr6QAPH7igaBguMxaQtlG64pHGHnODkm9Q3xQMEP+6Z7CXKVVX1ur1KWyirzvw60Mj7gHJX6n5KSMOPztIpJFKW+HrqJxfRwVjiMBtV51xB3U3f1v05O7qywirtvQoXY2x3bJkDPlRFg/KU2fXQPsKVu4k8ClXaHOxpQaTB1F3XSlxFeBw6uWP/fW5wyttA7ewMINJQJ7nP6njQsHArVNeiz1W7DxcVYmnHm10VsZQVPyuFesM7WXt17fJMAVusJ9YQ3rhwMkibAxhj5rvIfOqAK6GzEkXbY0VFsm03XuAKIabEePm0mROkweletwsQk/ZPuNSsbPUPsmBBP77RGgMxYSqGBdOqs8/AtnaH7U6QtQjy+uWE8nQv5zAYEnKdCIpa7VLVVekpX/q/CycldArfQWDvbGFOX0x7CiiBy6mhOGf2nJJ+Wh3d2t5ELCTkus/n5LLvjpetVqJJ63+ytgXhG2v3Et+Sg6gYz2cPx3cVhjqurJLsln/4Vcww=
  file: "target/spt-development-audit-spring-${POM_VERSION}.jar"
  skip_cleanup: true
  on:
    tags: true
