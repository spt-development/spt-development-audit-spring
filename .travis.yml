language: java

jdk:
  - openjdk8

script:
  - mvn test -B
  - mvn org.pitest:pitest-maven:mutationCoverage

before_deploy:
  - POM_VERSION=$(mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec)

# Releases config copied from https://docs.travis-ci.com/user/deployment/releases/ and secure key generated by following
# https://stackoverflow.com/questions/25302518/travis-ci-setup-releases-with-github-token#answer-57032190
deploy:
  provider: releases
  api_key:
    secure: AGbxzEsmMXAtBjZbr3P9eAi+jyGcgVURMfb6ive9cAnDQi2/F/oms0g866WppiZmDDGikerNFX/8F6KEnX5XsWK0zMUj67SwjooB/yiP1kuQHMSRqd6tYSZdY4b6EaxGx9hrqfntslHrH2nt3eD+L+z428mW2Wdm2+dYlkIR1hpNk0ji8hzZWRbws4mryCH1SdBpqKF9mJkfKUM1j0v0CHjd/jhlIuh7lDhcYQXaplZT1AjcSmxxJEqqVIMp1r4gVVz6COyN54twV0PFSk6lSWXgVci5IfR+eRI/8FrVudAvF9FzNCmIVVF+rfVN0jbnbEEqSSqr9Ks5kRtcf4OmGuw2VbkFr4jwmA7KPiosvWf50WauWRZPtJ2OnMF1YIoFwngDEhzHNNDpgs29K/Dvbf68VKO0E0ccEeAUeMU4XkGk/pRMF5hWBbHFWGkKu3mc25h0MOBIlbMxkR3QAIxNoq3sc+HCbk4gmjF8yqtMa9zQ+Cd0Rh0XtqjUob2O3BcmPGUu4FnEtOf2x+3aEfP/53UK33+vOln00cP6z6IDpZhG0fPP889c1oStKJGpGjkjG9yaow+tb5mMnik7ez5XmEn1qBw/l9UbeF4PpzHvJKxbsWvP7rYb4nsKx9jf0j2cmYx3ZG4dL3HlGRTPju3ork234wgP9Wcobgc6r0Io4MQ=
  file: "target/spt-development-audit-spring-${POM_VERSION}.jar"
  skip_cleanup: true
  on:
    tags: true
